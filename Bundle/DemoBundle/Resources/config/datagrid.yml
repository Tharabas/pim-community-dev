datagrid:
    contactGroup:
        source:
            acl_resource: orocrm_contact_group_view
            type: orm
            query:
                select:
                    - g.id
                    - g.label
                from:
                    - { table: OroCRMContactBundle:Group, alias: g }

        columns:
            label:
                type: field

        properties:
            update_link:
                type: url
                route: orocrm_contact_group_update
                params:
                    - id

            delete_link:
                type: url
                route: oro_api_delete_contactgroup
                params:
                    - id
        sorters:
            columns:
                label:
                    data_name: g.label

                id:
                    data_name: g.id

            default:
                label: %oro_grid.extension.orm_sorter.class%::DIRECTION_DESC

    adminUsers:
        source:
            type: orm
            query:
                select:
                    - u.id
                    - u.firstName
                    - u.lastName
                    - u.created
                from:
                    - { table: OroUserBundle:User, alias: u }

        columns:
            created:
                type: field
                frontend_type: date

        sorters:
            columns:
                hasRole:
                    data_name: hasRole

                firstName:
                    data_name: u.firstName

            default:
                hasRole: %oro_grid.extension.orm_sorter.class%::DIRECTION_DESC
                firstName: %oro_grid.extension.orm_sorter.class%::DIRECTION_ASC

        filters:
            columns:
                created:
                    type: date
                    data_name: u.created

            default:
                created:
                    type: \Oro\Bundle\FilterBundle\Form\Type\Filter\DateRangeFilterType::TYPE_MORE_THAN
                    value:
                        end: 2013-10-07 00:00

    account:
        source:
            type: orm
            query:
                select:
                    - a.id
                    - defaultContact.firstName as contactFirstName
                    - defaultContact.lastName as contactLastName
                    - defaultContactEmail.email as contactEmail
                    - defaultContactPhone.phone as contactPhone
                    - CONCAT(accountOwner.firstName, CONCAT(' ', accountOwner.lastName)) as ownerName
                from:
                    - { table: OroCRMAccountBundle:Account, alias: a }

                join:
                    left:
                        - { join: a.defaultContact, alias: defaultContact }
                        - { join: defaultContact.emails, alias: defaultContactEmail, conditionType: 'WITH', condition: 'defaultContactEmail.primary = true' }
                        - { join: defaultContact.phones, alias: defaultContactPhone, conditionType: 'WITH', condition: 'defaultContactPhone.primary = true' }
                        - { join: a.owner, alias: accountOwner }
        columns:
            name:
                type: field

            contactFirstName:
                type: field

            contactLastName:
                type: field

            contactPhone:
                type: field

            contactEmail:
                type: field

            ownerName:
                type: field

        flexible_attributes:
            phone:
                filterable: true
        flexible_entity: %orocrm_account.account.entity.class%

        filters:
            default:
                flexible_phone:
                    type: \Oro\Bundle\FilterBundle\Form\Type\Filter\TextFilterType::TYPE_ENDS_WITH
                    value: 'ddd'
